# Elasticsearch 검색 정확도 비교 실험

<br/>
<br/>

## 1. 실험 목적
Elasticsearch에서 서로 다른 검색 방식(분석기 및 퍼지 검색 적용 여부)에 따른 검색 정확도 및 응답 특성을 비교하기 위함.

<br/>
<br/>

## 2. 비교 대상

| 케이스 번호 | 인덱스 | 적용 분석기/토큰화 | 추가 옵션 |
|-------------|--------|--------------------|-----------|
| 1 | gangwon-poi | 기본 분석기 |  |
| 2 | gangwon-poi + fuzziness 적용 | 기본 분석기 | `"fuzziness": "AUTO"` |
| 3 | gangwon-poi-fuzzy | Nori 한글 분석기 |  |
| 4 | gangwon-poi-fuzzy + fuzziness 적용 | Nori 한글 분석기 | `"fuzziness": "AUTO"` |
| 5 | gangwon-poi-ngram | N-gram 분석기 |  |
| 6 | gangwon-poi-ngram + fuzziness 적용 | N-gram 분석기 | `"fuzziness": "AUTO"` |

<br/>

- **기본 분석기**: Elasticsearch 기본(Standard) 토큰화
- **Nori 한글 분석기**: 형태소 분석을 통한 한글 처리 강화
- **N-gram 분석기**: 연속된 글자 단위로 토큰 생성하여 부분 검색 가능

- Fuzziness 옵션
  - 편집 거리(Levenshtein distance)를 기반으로 철자 오타나 유사 단어를 허용하는 검색 기능
  - 오타 허용 글자 수를 의미하며, AUTO(단어 길이에 따라 자동 결정), 0(완전 일치), 1, 2 등의 값을 설정 가능

- gangwon-poi-ngram
  - 색인 시와 검색 시 서로 다른 분석기를 사용하도록 search_analyzer를 별도로 지정
  - 검색 시에는 기본 분석기를 사용


<br/>
<br/>
<br/>


## 3. 테스트 데이터

### default_queries.txt
  - 30개 단어  
  - 정상 표기된 검색어 위주

```
설악산
속초해수욕장
낙산사
오대산
평창휘닉스파크
강릉커피거리
안목해변
춘천닭갈비
대관령양떼목장
주문진항
```

### typo_queries.txt
  - 30개 단어  
  - 오타, 띄어쓰기 오류 중심

```
설악샨
속촤해수욕장
낙산 사
오대샨
휘닉스 평창
강릉 커피 거리
안목 해변
춘천닭칼비
```

<br/>
<br/>
<br/>


## 4. 테스트 결과

### 측정 항목
* 정답 비율 (공백 제거 후 포함 여부로 정답 판단)

### default_queries.txt

| 검색 방식                     | 정확도(%) |
| ------------------------- | ------ |
| gangwon-poi-fuzzOff       | 20.0%  |
| gangwon-poi-fuzzOn        | 23.3%  |
| gangwon-poi-fuzzy-fuzzOff | 26.7%  |
| gangwon-poi-fuzzy-fuzzOn  | 26.7%  |
| gangwon-poi-ngram-fuzzOff | 6.7%   |
| gangwon-poi-ngram-fuzzOn  | 10.0%  |


### typo_queries.txt

| 검색 방식                     | 정확도(%)    |
| ------------------------- | --------- |
| gangwon-poi-fuzzOff       | 23.3%     |
| gangwon-poi-fuzzOn        | 30.0%     |
| gangwon-poi-fuzzy-fuzzOff | 40.0% |
| gangwon-poi-fuzzy-fuzzOn  | 40.0% |
| gangwon-poi-ngram-fuzzOff | 20.0%     |
| gangwon-poi-ngram-fuzzOn  | 30.0%     |


<br/>
<br/>
<br/>

## 5. 결과 요약
* Nori 한글 분석기를 적용한 경우(-fuzzy-)가 가장 높은 정확도(40%)를 보였음.
* fuzziness 옵션은 대부분의 경우 정확도를 향상시켰으나, 한글분석기에서는 fuzziness On/Off 차이가 거의 없음.
* ngram 방식은 특정 띄어쓰기·오타 검색어에는 효과적일 수 있으나, 전체 정확도는 상대적으로 낮음.
* 기본 편집거리 기반(gangwon-poi) 대비 fuzziness 적용 시 약 6.7%~10%p 향상.

<br/>
<br/>
<br/>

## 6. 향후 개선
* 테스트 데이터
  * 데이터 양 늘리기

* 테스트 알고리즘
  * gangwon-poi-fuzzy도 search_analyzer를 기본 분석기로 지정했을 경우 추가

* 테스트 결과
  * 사람이 직접 판단하는 정답 여부 기록 및 비교
  * 응답시간, 총 검색 결과 수 같은 평가 항목 추가